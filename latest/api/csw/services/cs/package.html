<!DOCTYPE html >
<html>
        <head>
          <title>cs - csw.services.cs</title>
          <meta name="description" content="cs - csw.services.cs" />
          <meta name="keywords" content="cs csw.services.cs" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      <link href="../../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript" src="../../../lib/jquery.js" id="jquery-js"></script>
      <script type="text/javascript" src="../../../lib/jquery-ui.js"></script>
      <script type="text/javascript" src="../../../lib/template.js"></script>
      <script type="text/javascript" src="../../../lib/tools.tooltip.js"></script>
      
      <script type="text/javascript">
         if(top === self) {
            var url = '../../../index.html';
            var hash = 'csw.services.cs.package';
            var anchor = window.location.hash;
            var anchor_opt = '';
            if (anchor.length >= 1)
              anchor_opt = '@' + anchor.substring(1);
            window.location.href = url + '#' + hash + anchor_opt;
         }
   	  </script>
    
        </head>
        <body class="value">
      <div id="definition">
        <img alt="Package" src="../../../lib/package_big.png" />
        <p id="owner"><a href="../../package.html" class="extype" name="csw">csw</a>.<a href="../package.html" class="extype" name="csw.services">services</a></p>
        <h1>cs</h1><span class="permalink">
      <a href="../../../index.html#csw.services.cs.package" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <span class="name">cs</span>
      </span>
      </h4>
      
          <div id="comment" class="fullcommenttop"><div class="comment cmt"><h4> Configuration Service </h4><p>This project implements the Configuration Service, which is used to manage configuration
files by storing them in a Git repository.</p><h5> Config Service API </h5><p>The config service can be accessed by sending messages to the config service actor,
however the ConfigServiceClient wrapper class implements the ConfigManager trait
and provides a somewhat simpler API.</p><h5> Config Service Application </h5><p>Before starting the config service, the <i>location service</i>
and the the <i>config service annex server</i>
should both be running.
You can start the config service with the <code>cs</code> command (found under target/universal/stage/bin).
The default config service name and the location of the local and main Git repositories is defined in resources/reference.conf.
Alternatively you can specify a different config file on the command line in the same format.
You can also override the values with system properties. For example:</p><pre>cs -Dcsw.services.cs.name=MyConfigServiceName
   -Dcsw.services.cs.main-repository=http:<span class="cmt">//myHost/MyMainRepo/</span>
   -Dcsw.services.cs.local-repository=/myPath/MyLocalRepo</pre><p>Note that multiple config service instances may be running in the network, but the names an host:port combinations should
each be unique. Only a single config service instance should access a given local repository.</p><h5> Config Service Http Server </h5><p>The config service application (cs) also starts an http server
(optionally, if csw.services.cs.http.host is defined in the config file).
The HTTP/REST interface to the command service follows the scala and java APIs.</p><p>The <code>create</code> and <code>update</code> methods expect the file data to be posted.
The <code>path</code> query argument is always required. All other query arguments are optional.
The <code>id</code> argument (a <code>ConfigId</code>) must be taken from the JSON result of <code>create</code>, <code>update</code>, <code>list</code>, or <code>history</code>.</p><p>The format of the JSON returned from <code>create</code> and <code>update</code> is:
<code>{&quot;ConfigId&quot;:&quot;da807342bcc21766316c3a91a01f4a513a1adbb3&quot;}</code>. The <code>id</code> query argument passed to the other methods is
 the value at right.</p><h5> Example or using curl to access the Config Service Http Server </h5><p>Assuming that the config service http server is running on localhost on port 8541 (see config file, default: reference.conf):</p><pre>curl -X POST 'http:<span class="cmt">//localhost:8541/create?path=some/test1/TestConfig1&comment=comment+here' --data-binary @TestConfig1</span></pre><p>   Creates a new file in the config service named some/test1/TestConfig1 using the data in the local file TestConfig1.</p><pre>curl 'http:<span class="cmt">//localhost:8541/get?path=some/test1/TestConfig1' > TestConfig1a</span></pre><p>   Gets the contents of some/test1/TestConfig1 from the service and store in a local file.</p><pre>curl -X POST 'http:<span class="cmt">//localhost:8541/update?path=some/test1/TestConfig1&comment=some+comment' --data-binary @TestConfig1</span></pre><p>   Updates the contents of some/test1/TestConfig1 in the config service with the contents of the local file.</p><pre>curl -s 'http:<span class="cmt">//localhost:8541/history?path=some/test1/TestConfig1'</span></pre><p>   Returns JSON describing the history of some/test1/TestConfig1. You can pipe the output to json_pp to pretty print it:</p><pre>[
   {
      <span class="lit">"comment"</span> : <span class="lit">"update 2 comment"</span>,
      <span class="lit">"time"</span> : <span class="num">1421010506000</span>,
      <span class="lit">"id"</span> : <span class="lit">"3007e3369de4c05d4fb85d515df0be417243ecca"</span>
   },
   {
      <span class="lit">"comment"</span> : <span class="lit">"update 1 comment"</span>,
      <span class="lit">"time"</span> : <span class="num">1421010505000</span>,
      <span class="lit">"id"</span> : <span class="lit">"0fff71d0f3f4f88aa5986aa02c32d3c495c1c652"</span>
   },
   {
      <span class="lit">"comment"</span> : <span class="lit">"create comment"</span>,
      <span class="lit">"time"</span> : <span class="num">1421010505000</span>,
      <span class="lit">"id"</span> : <span class="lit">"f6e5266afc159f5d870ea1ac48c048ffa3913434"</span>
   }
]</pre><pre>curl 'http:<span class="cmt">//localhost:8541/list'</span></pre><p>   Returns JSON listing the files in the config service repository.</p><pre>[
   {
      <span class="lit">"comment"</span> : <span class="lit">"create comment"</span>,
      <span class="lit">"id"</span> : <span class="lit">"f6e5266afc159f5d870ea1ac48c048ffa3913434"</span>,
      <span class="lit">"path"</span> : <span class="lit">"some/test2/TestConfig2"</span>
   },
   {
      <span class="lit">"comment"</span> : <span class="lit">"update 2 comment"</span>,
      <span class="lit">"id"</span> : <span class="lit">"3007e3369de4c05d4fb85d515df0be417243ecca"</span>,
      <span class="lit">"path"</span> : <span class="lit">"some/test1/TestConfig1"</span>
   },
   {
      <span class="lit">"comment"</span> : <span class="lit">""</span>,
      <span class="lit">"id"</span> : <span class="lit">"77c35d529c1e46113bd2f68b6f0550e81d8dbfec"</span>,
      <span class="lit">"path"</span> : <span class="lit">"README"</span>
   }
]</pre><pre>curl 'http:<span class="cmt">//localhost:8541/getDefault?path=some/test1/TestConfig1</span></pre><p>   Returns the content of the default version of the file, which may or may not be the same as the latest version (see below).</p><pre>curl -X POST 'http:<span class="cmt">//localhost:8541/setDefault?path=some/test1/TestConfig1&id=da807342bcc21766316c3a91a01f4a513a1adbb3'</span></pre><p>   Sets the default version of the file to the one with the given id (an id returned by the history command).</p><pre>curl -X POST 'http:<span class="cmt">//localhost:8541/resetDefault?path=some/test1/TestConfig1'</span></pre><p>   Resets the default version of the file to be the latest version.</p><h5> Main Packages </h5><ul><li>core - the core implementation of the API based on JGit</li><li>akka - (based on core) the Akka actor interface as well as the http server and client interfaces.</li></ul><p>Large/binary files can slow down the Git repository, so these are stored separately using
the the ConfigServiceAnnex http file server.</p><p>When you first create a config file, you can choose to store it in the normal way (in the Git repository)
or as a *large/binary* file, in which case only *$file.sha1* is checked in, containing the SHA-1 hash of the
file's contents. The actual binary file is then stored on the annex server in a file name based on the SHA-1 hash.</p><p>The config service also supports the concept of *default versions* of files. In this case a file named
  *$file.default* is checked in to Git behind the scenes and contains the id of the default version of the file.
If there is no default, this file is not present and the latest version is always considered the default.</p><p>The config service can be started as a standalone application. *sbt stage* installs the command under
target/universal/stage/bin.
The standalone configs service registers itself with the location service so that it
can be found by other applications.</p><p>The contents of the files are exchanged using [Akka reactive streams](http://www.typesafe.com/activator/template/akka-stream-scala).</p><h5> No concurrent access to local Git repository </h5><p>Note that each instance of the config service should manage its own local Git repository.
All of the local repositories may reference a common central repository, however it is probably not
safe to allow concurrent access to the local Git repository, which reads and writes files
in the Git working directory.</p><p>Having copies of the files in the Git working directory has the advantage of being a kind of *cache*,
so that the files do not have to be pulled from the server each time they are needed.
However care needs to be taken not to allow different threads to potentially read and write the
same files at once.</p><h5> Running the tests </h5><p>To run the unit tests, use <code>sbt test</code>.
To run the multi-jvm tests, use <code>sbt multi-jvm:test</code>.
</p></div><div class="toggleContainer block">
          <span class="toggle">Linear Supertypes</span>
          <div class="superTypes hiddenContent"><a href="../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a>, <a href="http://www.scala-lang.org/api/2.11.7/index.html#scala.Any" class="extype" target="_top">Any</a></div>
        </div></div>
        

      <div id="mbrsel">
        <div id="textfilter"><span class="pre"></span><span class="input"><input id="mbrsel-input" type="text" accesskey="/" /></span><span class="post"></span></div>
        <div id="order">
              <span class="filtertype">Ordering</span>
              <ol>
                
                <li class="alpha in"><span>Alphabetic</span></li>
                <li class="inherit out"><span>By inheritance</span></li>
              </ol>
            </div>
        <div id="ancestors">
                <span class="filtertype">Inherited<br />
                </span>
                <ol id="linearization">
                  <li class="in" name="csw.services.cs"><span>cs</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li>
                </ol>
              </div><div id="ancestors">
            <span class="filtertype"></span>
            <ol>
              <li class="hideall out"><span>Hide All</span></li>
              <li class="showall in"><span>Show all</span></li>
            </ol>
          </div>
        <div id="visbl">
            <span class="filtertype">Visibility</span>
            <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
          </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        <div id="types" class="types members">
              <h3>Type Members</h3>
              <ol><li name="csw.services.cs.JConfigData" visbl="pub" data-isabs="true" fullComment="no" group="Ungrouped">
      <a id="JConfigDataextendsObject"></a>
      <a id="JConfigData:JConfigData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">trait</span>
      </span>
      <span class="symbol">
        <a href="JConfigData.html"><span class="name">JConfigData</span></a><span class="result"> extends <a href="../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#csw.services.cs.package@JConfigDataextendsObject" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="csw.services.cs.JConfigManager" visbl="pub" data-isabs="true" fullComment="no" group="Ungrouped">
      <a id="JConfigManagerextendsObject"></a>
      <a id="JConfigManager:JConfigManager"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">trait</span>
      </span>
      <span class="symbol">
        <a href="JConfigManager.html"><span class="name">JConfigManager</span></a><span class="result"> extends <a href="../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#csw.services.cs.package@JConfigManagerextendsObject" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li></ol>
            </div>

        

        <div id="values" class="values members">
              <h3>Value Members</h3>
              <ol><li name="csw.services.cs.akka" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="akka"></a>
      <a id="akka:akka"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="akka/package.html"><span class="name">akka</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#csw.services.cs.package@akka" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">Defines the Config Service actor, http server and client.</p>
    </li><li name="csw.services.cs.core" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="core"></a>
      <a id="core:core"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="core/package.html"><span class="name">core</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#csw.services.cs.package@core" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">Defines the API for storing and retrieving configuration information.</p><div class="fullcomment"><div class="comment cmt"><p>Defines the API for storing and retrieving configuration information.
Akka streams are used to transfer files between client and server.
</p></div></div>
    </li></ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        <div class="parent" name="scala.AnyRef">
              <h3>Inherited from <a href="../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></h3>
            </div><div class="parent" name="scala.Any">
              <h3>Inherited from <a href="http://www.scala-lang.org/api/2.11.7/index.html#scala.Any" class="extype" target="_top">Any</a></h3>
            </div>
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>


    </body>
      </html>
