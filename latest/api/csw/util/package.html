<!DOCTYPE html >
<html>
        <head>
          <title>util - csw.util</title>
          <meta name="description" content="util - csw.util" />
          <meta name="keywords" content="util csw.util" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      <link href="../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript" src="../../lib/jquery.js" id="jquery-js"></script>
      <script type="text/javascript" src="../../lib/jquery-ui.js"></script>
      <script type="text/javascript" src="../../lib/template.js"></script>
      <script type="text/javascript" src="../../lib/tools.tooltip.js"></script>
      <script type="text/javascript" src="../../lib/modernizr.custom.js"></script><script type="text/javascript" src="../../lib/diagrams.js" id="diagrams-js"></script>
      <script type="text/javascript">
         if(top === self) {
            var url = '../../index.html';
            var hash = 'csw.util.package';
            var anchor = window.location.hash;
            var anchor_opt = '';
            if (anchor.length >= 1)
              anchor_opt = '@' + anchor.substring(1);
            window.location.href = url + '#' + hash + anchor_opt;
         }
   	  </script>
    
        </head>
        <body class="value">
      <div id="definition">
        <img alt="Package" src="../../lib/package_big.png" />
        <p id="owner"><a href="../package.html" class="extype" name="csw">csw</a></p>
        <h1>util</h1><span class="permalink">
      <a href="../../index.html#csw.util.package" title="Permalink" target="_top">
        <img src="../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <span class="name">util</span>
      </span>
      </h4>
      
          <div id="comment" class="fullcommenttop"></div>
        

      <div id="mbrsel">
        <div id="textfilter"><span class="pre"></span><span class="input"><input id="mbrsel-input" type="text" accesskey="/" /></span><span class="post"></span></div>
        
        
        <div id="visbl">
            <span class="filtertype">Visibility</span>
            <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
          </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        

        

        <div id="values" class="values members">
              <h3>Value Members</h3>
              <ol><li name="csw.util.akka" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="akka"></a>
      <a id="akka:akka"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="akka/package.html"><span class="name">akka</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../index.html#csw.util.package@akka" title="Permalink" target="_top">
        <img src="../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="csw.util.config" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="config"></a>
      <a id="config:config"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="config/package.html"><span class="name">config</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../index.html#csw.util.package@config" title="Permalink" target="_top">
        <img src="../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">This project is intended to hold reusable utility classes used throughout the csw source code.</p><div class="fullcomment"><div class="comment cmt"><h4> Utility Classes </h4><p>This project is intended to hold reusable utility classes used throughout the csw source code.</p><h5> Configurations and Events </h5><p>This project contains classes and traits used for *configurations* and *events*.
These are all based on type-safe keys and items (a set of values with optional units).
Each key has a specific type and the key's values must be of that type.</p><p>There are a variety of similar classes, used for different purposes:</p><p>Configurations:</p><p>- SetupConfig
- ObserveConfig</p><p>Events:</p><p>- StatusEvent
- ObserveEvent
- SystemEvent</p><p>State Variables:</p><p>- CurrentState
- DemandState</p><p>The key/value store and event service make use of these classes, which need to be
serialized and deserialized for external storage (in Redis or Hornetq, for example).
The <a href="config/ConfigSerializer$.html" class="extype" name="csw.util.config.ConfigSerializer">csw.util.config.ConfigSerializer</a> class provides support for this.</p><h5> Scala and Java APIs </h5><p>All the config and event classes are immutable. The <code>set</code> methods return a new instance of the object with a
new item added and the <code>get</code> methods return an Option, in case the Key is not found. There are also <code>value</code> methods
that return a value directly, throwing an exception if the key or value is not found.</p><h5> Key Types </h5><p>A set of standard key types and matching items are defined. Each key accepts one or more values
of the given type. The values are stored internally in a Vector:</p><p>- IntKey</p><p>- ShortKey</p><p>- LongKey</p><p>- FloatKey</p><p>- DoubleKey</p><p>- StringKey</p><p>- CharKey</p><p>- BooleanKey</p><p>The following keys support one or more values that are each one or two dimensional arrays (stored internally as Arrays):</p><p>- IntArrayKey, IntMatrixKey</p><p>- ShortArrayKey, ShortMatrixKey</p><p>- LongArrayKey, LongMatrixKey</p><p>- FloatArrayKey, FloatMatrixKey</p><p>- DoubleArrayKey, DoubleMatrixKey</p><p>In addition there is a GenericKey class that can be used for custom types. It is however recommended to
use only the standard key types, in oder to ensure that binary and JSON serialization and deserialization
works everywhere.</p><p>Example:</p><pre><span class="cmt">// Define a key for an event id</span>
<span class="kw">val</span> eventNum = IntKey(<span class="lit">"eventNum"</span>)

<span class="kw">val</span> exposureTime = DoubleKey(<span class="lit">"exposureTime"</span>)

<span class="cmt">// Define a key for image data</span>
<span class="kw">val</span> imageData = IntArrayKey(<span class="lit">"imageData"</span>)

<span class="cmt">// Dummy image data</span>
<span class="kw">val</span> testImageData = IntArray(<span class="std">Array</span>.ofDim[<span class="std">Int</span>](<span class="num">10000</span>))

<span class="kw">val</span> prefix = <span class="lit">"tcs.mobie.red.dat.exposureInfo"</span>

<span class="cmt">// ...</span>

  <span class="kw">val</span> config = SetupConfig(prefix)
    .add(eventNum.set(num))
    .add(exposureTime.set(<span class="num">1.0</span>))
    .add(imageData.set(testImageData))

<span class="cmt">// Or you can use the Scala DSL to do the same thing:</span>

  <span class="kw">import</span> csw.util.config.ConfigDSL._

  sc(prefix,
     eventNum -&gt; num,
     exposureTime -&gt; <span class="num">1.0</span>,
     imageData -&gt; testImageData)</pre><p>Java Example:</p><pre><span class="kw">import</span> static javacsw.util.config.JItems.*;
<span class="kw">import</span> static javacsw.util.config.JConfigDSL.*;

static <span class="kw">final</span> DoubleKey exposureTime = <span class="kw">new</span> DoubleKey(<span class="lit">"exposureTime"</span>);

<span class="cmt">// Define a key for an event id</span>
static <span class="kw">final</span> IntKey eventNum = <span class="kw">new</span> IntKey(<span class="lit">"eventNum"</span>);

<span class="cmt">// Define a key for image data</span>
static <span class="kw">final</span> IntArrayKey imageData = <span class="kw">new</span> IntArrayKey(<span class="lit">"imageData"</span>);

<span class="cmt">// Dummy image data</span>
static <span class="kw">final</span> JIntArray testImageData = JIntArray.fromArray(<span class="kw">new</span> int[<span class="num">10000</span>]);

<span class="cmt">// Prefix to use for the event</span>
static <span class="kw">final</span> <span class="std">String</span> prefix = <span class="lit">"tcs.mobie.red.dat.exposureInfo"</span>;

<span class="cmt">// ...</span>

  SetupConfig config = <span class="kw">new</span> SetupConfig(prefix)
    .add(jset(eventNum, num))
    .add(jset(exposureTime, <span class="num">1.0</span>))
    .add(jset(imageData, testImageData));

  <span class="cmt">// Alternative syntax</span>
  SetupConfig config = jadd(sc(prefix,
    jset(eventNum, num),
    jset(exposureTime, <span class="num">1.0</span>),
    jset(imageData, testImageData));</pre><p>Scala Example using a matrix as the key value:</p><pre><span class="kw">val</span> k1 = DoubleMatrixKey(<span class="lit">"myMatrix"</span>)
<span class="kw">val</span> dm1 = DoubleMatrix(<span class="std">Array</span>(<span class="std">Array</span>[<span class="std">Double</span>](<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>), <span class="std">Array</span>[<span class="std">Double</span>](<span class="num">2</span>, <span class="num">3</span>, <span class="num">6</span>), <span class="std">Array</span>[<span class="std">Double</span>](<span class="num">4</span>, <span class="num">6</span>, <span class="num">12</span>)))
<span class="kw">val</span> sc1 = sc(<span class="lit">"test"</span>, k1 -&gt; dm1 withUnits UnitsOfMeasure.Deg)
assert(setupConfig1.get(k1).get.head(<span class="num">0</span>, <span class="num">0</span>) == <span class="num">1</span>)</pre><p>Java Example:</p><pre><span class="kw">final</span> DoubleMatrixKey k1 = DoubleMatrixKey(<span class="lit">"matrixTest"</span>);
double[][] m1 = {{<span class="num">1.</span>, <span class="num">2.</span>, <span class="num">3.</span>}, {<span class="num">4.</span>, <span class="num">5.</span>, <span class="num">6.</span>}, {<span class="num">7.</span>, <span class="num">8.</span>, <span class="num">9.</span>}};
DoubleMatrix dm1 = DoubleMatrix(m1);
SetupConfig sc1 = jadd(sc(<span class="lit">"test"</span>), jset(k1, dm1));
assertTrue(jvalue(jitem(sc1, k1)).apply(<span class="num">0</span>, <span class="num">0</span>) == <span class="num">1</span>);</pre><h5> Combining Configs </h5><p>In some cases you may need to wrap multiple configs, for example to pass to an assembly.</p><pre><span class="kw">val</span> encoder2 = IntKey(<span class="lit">"encoder2"</span>)
<span class="kw">val</span> xOffset = IntKey(<span class="lit">"xOffset"</span>)
<span class="kw">val</span> yOffset = IntKey(<span class="lit">"yOffset"</span>)
<span class="kw">val</span> obsId = <span class="lit">"Obs001"</span>

<span class="kw">val</span> sc1 = SetupConfig(ck1).madd(encoder1.set(<span class="num">22</span>), encoder2.set(<span class="num">33</span>))
<span class="kw">val</span> sc2 = SetupConfig(ck1).madd(xOffset.set(<span class="num">1</span>), yOffset.set(<span class="num">2</span>))
<span class="kw">val</span> configArg = SetupConfigArg(obsId, sc1, sc2)

assert(configArg.info.obsId.obsId == obsId)
assert(configArg.configs.toList == <span class="std">List</span>(sc1, sc2))</pre><p>Java API:</p><pre>IntKey encoder1 = IntKey(<span class="lit">"encoder1"</span>);
IntKey encoder2 = IntKey(<span class="lit">"encoder2"</span>);
IntKey xOffset = IntKey(<span class="lit">"xOffset"</span>);
IntKey yOffset = IntKey(<span class="lit">"yOffset"</span>);
<span class="std">String</span> obsId = <span class="lit">"Obs001"</span>;

SetupConfig sc1 = jadd(sc(ck1), jset(encoder1, <span class="num">22</span>), jset(encoder2, <span class="num">33</span>));
SetupConfig sc2 = jadd(sc(ck1), jset(xOffset, <span class="num">1</span>), jset(yOffset, <span class="num">2</span>));
SetupConfigArg configArg = Configurations.createSetupConfigArg(obsId, sc1, sc2);

assertTrue(configArg.info().obsId().obsId().equals(obsId));
assertTrue(configArg.jconfigs().equals(Arrays.asList(sc1, sc2)));</pre></div></div>
    </li></ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>


    </body>
      </html>
