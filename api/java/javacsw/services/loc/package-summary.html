<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_111) on Sat Dec 03 22:50:03 CET 2016 -->
<title>javacsw.services.loc</title>
<meta name="date" content="2016-12-03">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="javacsw.services.loc";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../javacsw/services/events/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../javacsw/services/pkg/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?javacsw/services/loc/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;javacsw.services.loc</h1>
<div class="docSummary">
<div class="block">The Location Service helps you to find out the hostname and port number for a service,
 as well as other information for determining the correct URI to use, such as the path,
 the actor system name and the config prefix.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/AbstractLocationTrackerClientActor.html" title="class in javacsw.services.loc">AbstractLocationTrackerClientActor</a></td>
<td class="colLast">
<div class="block">Java API abstract base class for an actor that wants to track connections with the location service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JComponentId.html" title="class in javacsw.services.loc">JComponentId</a></td>
<td class="colLast">
<div class="block">Java API to the location service ComponentId class, which is Used to identify a component.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JComponentType.html" title="class in javacsw.services.loc">JComponentType</a></td>
<td class="colLast">
<div class="block">Java API for location service component types.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JConnection.html" title="class in javacsw.services.loc">JConnection</a></td>
<td class="colLast">
<div class="block">Java API for location service connections</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JConnectionType.html" title="class in javacsw.services.loc">JConnectionType</a></td>
<td class="colLast">
<div class="block">Java API for location service connection type: Indicates if it is an http server or an akka actor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JLocationService.html" title="class in javacsw.services.loc">JLocationService</a></td>
<td class="colLast">
<div class="block">Java API for the Location Service

 The Location Service is based on Multicast DNS (AppleTalk, Bonjour) and can be used to register and lookup
 akka and http based services in the local network.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JLocationServiceSup.html" title="class in javacsw.services.loc">JLocationServiceSup</a></td>
<td class="colLast">
<div class="block">Scala side Java API support for the location service.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JLocationServiceSup$.html" title="class in javacsw.services.loc">JLocationServiceSup$</a></td>
<td class="colLast">
<div class="block">Scala side Java API support for the location service.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JLocationSubscriberActor.html" title="class in javacsw.services.loc">JLocationSubscriberActor</a></td>
<td class="colLast">
<div class="block">Java API for Scala TrackerSubscriber</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JLocationTracker.html" title="class in javacsw.services.loc">JLocationTracker</a></td>
<td class="colLast">
<div class="block">Java API for creating a LocationTracker actor</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/loc/JRegistrationTracker.html" title="class in javacsw.services.loc">JRegistrationTracker</a></td>
<td class="colLast">
<div class="block">Java API to creating a RegistrationTracker actor</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package javacsw.services.loc Description">Package javacsw.services.loc Description</h2>
<div class="block">The Location Service helps you to find out the hostname and port number for a service,
 as well as other information for determining the correct URI to use, such as the path,
 the actor system name and the config prefix.
 <p>
 The location service is based on Multicast DNS (mDNS). The server process is running by default on
 Mac OS X and Linux. Make sure the firewall is either disabled or allows port 5353/UDP.
 <p>
 <strong>Important</strong>
 <p>
 Before starting any services that use the location service, this method should be called once:
 <pre> <code>
 LocationService.initInterface()
 </code> </pre>
 This determines the primary IP address of the local host and sets some system variables that
 control which IP address is used. If you forget to call this method, there is a chance that
 the wrong IP address will be advertised (there is often more than one).
 <p>
 If you want to specify the IP address yourself, you can also call it like this:
 <pre> <code>
 LocationService.initInterface(hostnameOrIpAddress)
 </code> </pre>
 <strong>Service Types</strong>
 <p>
 Two types of services are currently supported: Akka/actor based and HTTP based services.
 To register an Akka actor based service, you can use code like this:
 <pre> <code>
   ComponentId componentId = JComponentId.componentId(assemblyName, Assembly);
   JLocationService.registerAkkaConnection(componentId, self(), prefix, getContext().system());
 </code> </pre>
 Where self is a reference to the services own actorRef and the prefix argument indicates the
 part of a configuration the actor is interested in receiving.
 <p>
 To register an HTTP based service, you can make a call like this:
 <pre> <code>
    JLocationService.registerHttpConnection(componentId, port, uriPath, getContext().system());
 </code> </pre>
 Here you specify the port number and URI path for the http server. The hostname is automatically determined.
 In both cases the return value from the register method can be used to later unregister from the location service.
 <p>
 <strong>Using the Location Service as a Client</strong>
 <p>
 In Java, the easiest way to use the location service in an actor to keep track of connections to other applications
 is to inherit from a class that inherits the Scala <a href="../../../csw/services/loc/LocationTrackerClientActor.html" title="interface in csw.services.loc"><code>LocationTrackerClientActor</code></a>
 trait (such as <a href="../../../javacsw/services/loc/AbstractLocationTrackerClientActor.html" title="class in javacsw.services.loc"><code>AbstractLocationTrackerClientActor</code></a>
 or <a href="../../../javacsw/services/pkg/JAssemblyController.html" title="class in javacsw.services.pkg"><code>JAssemblyController</code></a>).
 Then you can override the `allResolved` method to be notified with connection details once (and whenever)
 all connections have been resolved.
 <p>
 In the following example, `TestServiceClient` depends on a number of `TestAkkaService-*` and `TestHttpService-*` connections:
 <pre> <code>
 public class TestServiceClient extends AbstractLocationTrackerClientActor {

     // Used to create the TestServiceClient actor
     static Props props(int numServices) {
         return Props.create(new Creator&lt;TestServiceClient&gt;() {
             private static final long serialVersionUID = 1L;

             public TestServiceClient create() throws Exception {
                 return new TestServiceClient(numServices);
             }
         });
     }

     LoggingAdapter log = Logging.getLogger(getContext().system(), this);


     // Constructor: tracks the given number of akka and http connections
     public TestServiceClient(int numServices) {
         for(int i = 0; i &lt; numServices; i++) {
             trackConnection(TestAkkaService.connection(i+1));
             trackConnection(TestHttpService.connection(i+1));
         }

         // Actor messages are handled by the parent class (in trackerClientReceive method)
         receive(trackerClientReceive().orElse(ReceiveBuilder.
                 matchAny(t -&gt; log.warning("Unknown message received: " + t)).
                 build()));
     }

     // Called when all connections are resolved
     public void allResolved(Set&lt;LocationService.Location&gt; locations) {
         List&lt;String&gt; names = new ArrayList&lt;&gt;();
         locations.forEach(loc -&gt; names.add(loc.connection().componentId().name()));
         log.debug("Test Passed: Received services: " + names.stream().collect(Collectors.joining(", ")));
     }

     // If a command line arg is given, it should be the number of (akka, http) pairs of services to start (default: 1 of each).
     // The client and service applications can be run on the same or different hosts.
     public static void main(String[] args) {
         int numServices = 1;
         if (args.length != 0)
             numServices = Integer.valueOf(args[0]);

         LocationService.initInterface();
         ActorSystem system = ActorSystem.create();
         system.actorOf(TestServiceClient.props(numServices));
     }
 }
 </code> </pre>

 <strong>Command Line Tools</strong>

 On a Mac, you can use the dns-sd command to view information about registered services.
 For example:
 <pre> <code>
 dns-sd -B _csw._tcp
 </code> </pre>
 will continuously display CSW services added or removed, while:
 <pre> <code>
 dns-sd -L TestAkkaService-assembly-akka _csw._tcp
 </code> </pre>
 will list information about the application with the DNS name `TestAkkaService-assembly-akka` (not case sensitive).
 `_csw._tcp` is the mDNS type used for all CSW services. The default domain is `local.`.
 The CSW/mDNS application names here are in the format: *name-serviceType-accessType*,
 where *serviceType* is assembly, hcd, etc. and *accessType* is `http` or `akka`.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../javacsw/services/events/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../javacsw/services/pkg/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?javacsw/services/loc/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
