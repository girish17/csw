<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_111) on Sat Dec 03 22:50:03 CET 2016 -->
<title>javacsw.services.cs</title>
<meta name="date" content="2016-12-03">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="javacsw.services.cs";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../javacsw/services/ccs/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../javacsw/services/cs/akka/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?javacsw/services/cs/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;javacsw.services.cs</h1>
<div class="docSummary">
<div class="block">Defines synchronous (blocking) and asynchronous (non-blocking) Java APIs for the config service.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/cs/IBlockingConfigData.html" title="interface in javacsw.services.cs">IBlockingConfigData</a></td>
<td class="colLast">
<div class="block">Java synchronous interface to ConfigData</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/cs/IBlockingConfigManager.html" title="interface in javacsw.services.cs">IBlockingConfigManager</a></td>
<td class="colLast">
<div class="block">Defines a synchronous (blocking) java interface for storing and retrieving configuration information</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../javacsw/services/cs/IConfigData.html" title="interface in javacsw.services.cs">IConfigData</a></td>
<td class="colLast">
<div class="block">Java asynchronous interface to ConfigData</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../javacsw/services/cs/IConfigManager.html" title="interface in javacsw.services.cs">IConfigManager</a></td>
<td class="colLast">
<div class="block">Defines an asynchronous (non-blocking) java interface for storing and retrieving configuration information</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package javacsw.services.cs Description">Package javacsw.services.cs Description</h2>
<div class="block">Defines synchronous (blocking) and asynchronous (non-blocking) Java APIs for the config service.
 <p>
 <strong>Configuration Service</strong>
 <p>
 This project implements the Configuration Service, which is used to manage configuration
 files by storing them in a repository (by default, using Subversion).
 <p>
 <strong> Config Service API </strong>
 <p>
 The config service can be accessed by sending messages to the config service actor,
 however client wrapper classes provide a somewhat simpler API.
 See <a href="../../../javacsw/services/cs/IBlockingConfigManager.html" title="interface in javacsw.services.cs"><code>IBlockingConfigManager</code></a> for a simple, blocking API
 and <a href="../../../javacsw/services/cs/IConfigManager.html" title="interface in javacsw.services.cs"><code>IConfigManager</code></a> for a non-blocking API that returns future values.
 <p>
 Data returned from the config service is accessed via the <a href="../../../javacsw/services/cs/IConfigData.html" title="interface in javacsw.services.cs"><code>IConfigData</code></a> interface,
 which allows writing the data to a file or output stream or returning it as a String (assuming the data is not binary).
 The interface also provides static factory methods to create instances to pass to the config service methods.
 <p>
  Here is an example of how to use the Java blocking API to create, update and get files:
 <pre> <code>
  // Lookup already running default config service with the location service
  JBlockingConfigServiceClient client = JConfigServiceFactory.getBlockingConfigServiceClient(system, timeout);
  Boolean oversize = false; // Set to true to for special handling of large files

  // Add, then update the file twice
  ConfigId createId1 = manager.create(path1, IConfigData.create(contents1), oversize, comment1);
  ConfigId createId2 = manager.create(path2, IConfigData.create(contents1), oversize, comment1);
  ConfigId updateId1 = manager.update(path1, IConfigData.create(contents2), comment2);
  ConfigId updateId2 = manager.update(path1, IConfigData.create(contents3), comment3);

  // Check that we can access each version
  IBlockingConfigData data1 = manager.get(path1).get();
  IBlockingConfigData data2 = manager.get(path1, createId1).get();
  IBlockingConfigData data3 = manager.get(path1, updateId1).get();
  IBlockingConfigData data4 = manager.get(path1, updateId2).get();
  IBlockingConfigData data5 = manager.get(path2).get();
  IBlockingConfigData data6 = manager.get(path2, createId2).get();

  // Get the file history()
  List&lt;ConfigFileHistory&gt; historyList1 = manager.history(path1);
  List&lt;ConfigFileHistory&gt; historyList2 = manager.history(path2);

  // Get a list of all the files in the config service
  List&lt;ConfigFileInfo&gt; list = manager.list();
 </code></pre>
 <p>
 <strong> Config Service Application </strong>
 <p>
 Before starting the config service, the ''config service annex server'' should  be running.
 You can start the config service with the `cs` command (found under target/universal/stage/bin, or in the install/bin dir).
 The default config service name and the location of the git or svn repository is defined in resources/reference.conf.
 Alternatively you can specify a different config file on the command line in the same format.
 You can also override the values with system properties. For example:
 <pre> <code>
 cs -Dcsw.services.cs.name=MyConfigServiceName
 -Dcsw.services.cs.main-repository=http://myHost/MyMainRepo/
 -Dcsw.services.cs.local-repository=/myPath/MyLocalRepo
 </code></pre>
 Note that multiple config service instances may be running in the network, but the names an host:port combinations should
 each be unique. Only a single config service instance should access a given local repository.
 <p>
 <strong> Config Service Http Server </strong>
 <p>
 The config service application (cs) also starts an http server
 (optionally, if csw.services.cs.http.host is defined in the config file).
 The HTTP/REST interface to the command service follows the scala and java APIs.
 <p>
 The `path` query argument is always required. All other query arguments are optional.
 The `id` argument (a `ConfigId`) must be taken from the JSON result of `create`, `update`, `list`, or `history`.
 <p>
 The format of the JSON returned from `create` and `update` is:
 `{"ConfigId":"da807342bcc21766316c3a91a01f4a513a1adbb3"}`. The `id` query argument passed to the other methods is
 the value at right.
 <p>
 <strong> Example or using curl to access the Config Service Http Server </strong>
 <p>
 Assuming that the config service http server is running on localhost on port 8541 (see config file, default: reference.conf):
 <pre> <code>
 curl -X POST 'http://localhost:8541/create?path=some/test1/TestConfig1&amp;comment=comment+here' --data-binary @TestConfig1
 </code></pre>
 Creates a new file in the config service named some/test1/TestConfig1 using the data in the local file TestConfig1.
 <pre> <code>
 curl 'http://localhost:8541/get?path=some/test1/TestConfig1' &gt; TestConfig1a
 </code></pre>
 Gets the contents of some/test1/TestConfig1 from the service and store in a local file.
 <pre> <code>
 curl -X PUT 'http://localhost:8541/update?path=some/test1/TestConfig1&amp;comment=some+comment' --data-binary @TestConfig1
 </code></pre>
 Updates the contents of some/test1/TestConfig1 in the config service with the contents of the local file.
 <pre> <code>
 curl -s 'http://localhost:8541/history?path=some/test1/TestConfig1'
 </code></pre>
 Returns JSON describing the history of some/test1/TestConfig1. You can pipe the output to json_pp to pretty print it:
 <pre> <code>
 [
 {
 "comment" : "update 2 comment",
 "time" : 1421010506000,
 "id" : "3007e3369de4c05d4fb85d515df0be417243ecca"
 },
 {
 "comment" : "update 1 comment",
 "time" : 1421010505000,
 "id" : "0fff71d0f3f4f88aa5986aa02c32d3c495c1c652"
 },
 {
 "comment" : "create comment",
 "time" : 1421010505000,
 "id" : "f6e5266afc159f5d870ea1ac48c048ffa3913434"
 }
 ]
 </code></pre>

 <pre> <code>
 curl 'http://localhost:8541/list'
 </code></pre>
 <p>
 Returns JSON listing the files in the config service repository.
 <p>
 <pre> <code>
 [
 {
 "comment" : "create comment",
 "id" : "f6e5266afc159f5d870ea1ac48c048ffa3913434",
 "path" : "some/test2/TestConfig2"
 },
 {
 "comment" : "update 2 comment",
 "id" : "3007e3369de4c05d4fb85d515df0be417243ecca",
 "path" : "some/test1/TestConfig1"
 },
 {
 "comment" : "",
 "id" : "77c35d529c1e46113bd2f68b6f0550e81d8dbfec",
 "path" : "README"
 }
 ]
 </code></pre>

 <pre> <code>
 curl 'http://localhost:8541/getDefault?path=some/test1/TestConfig1
 </code></pre>
 Returns the content of the default version of the file, which may or may not be the same as the latest version (see below).
 <pre> <code>
 curl -X POST 'http://localhost:8541/setDefault?path=some/test1/TestConfig1&amp;id=da807342bcc21766316c3a91a01f4a513a1adbb3'
 </code></pre>
 Sets the default version of the file to the one with the given id (an id returned by the history command).
 <pre> <code>
 curl -X POST 'http://localhost:8541/resetDefault?path=some/test1/TestConfig1'
 </code></pre>
 Resets the default version of the file to be the latest version.
 <p>
 <strong> Main Packages </strong>
 <p>
 - core - the core implementation of the API based on git or svn
 <p>
 - akka - (based on core) the Akka actor interface as well as the http server and client interfaces.
 <p>
 Large/binary files can slow down the repository, so these can be stored separately using
 the the ConfigServiceAnnex http file server.
 <p>
 When you first create a config file, you can choose to store it in the normal way (in the repository)
 or as a <em>large/binary</em> file, in which case only <em>$file.sha1</em> is checked in, containing the SHA-1 hash of the
 file's contents. The actual binary file is then stored on the annex server in a file name based on the SHA-1 hash.
 <p>
 The config service also supports the concept of *default versions* of files. In this case a file named
 <em>$file.default</em> is checked in behind the scenes and contains the id of the default version of the file.
 If there is no default, this file is not present and the latest version is always considered the default.
 <p>
 The config service can be started as a standalone application. <em>sbt stage</em> installs the command under
 target/universal/stage/bin.
 The standalone configs service registers itself with the location service so that it
 can be found by other applications.
 <p>
 The contents of the files are exchanged using [Akka reactive streams](http://www.typesafe.com/activator/template/akka-stream-scala).
 <p>
 <strong> No concurrent access to local Git repository </strong>
 <p>
 Note that if using Git, each instance of the config service should manage its own local Git repository.
 All of the local repositories may reference a common central repository, however it is probably not
 safe to allow concurrent access to the local Git repository, which reads and writes files
 in the Git working directory.
 <p>
 Having copies of the files in the Git working directory has the advantage of being a kind of <em>cache</em>,
 so that the files do not have to be pulled from the server each time they are needed.
 However care needs to be taken not to allow different threads to potentially read and write the
 same files at once.
 <p>
 When using svn (the default setting) this should not be a problem, since no local repository or working
 directory is used.
 <p>
 <strong> Running the tests </strong>
 <p>
 To run the unit tests, use <code>sbt test</code>.
 <p>
 To run the multi-jvm tests, use <code>sbt multi-jvm:test</code>.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../javacsw/services/ccs/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../javacsw/services/cs/akka/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?javacsw/services/cs/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
